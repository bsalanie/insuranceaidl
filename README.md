InsuranceAI
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

We read the data and we convert the variables to their correct types:

## selecting variables

We will work with a subset of the variables. Our endogeneous variables
will be `Comprehensive coverage` for the choice of contract $y_1$ and
`Not at fault` for the occurrence of a claim at fault $y_2$. We also use
the variable `Duration` to weight the observations, and 9 categorical
covariates.

``` python
X.describe()
```

``` python
lhs_vars = pd.DataFrame({
    'Comprehensive coverage': y1, 
    'Claim at fault': y2, 'Duration': w
})
lhs_vars.describe()
```

The matrix of $(y_1,y_2)$ is as follows:

``` python
pd.crosstab(lhs_vars['Comprehensive coverage'], lhs_vars['Claim at fault'])
```

``` python
fig, ax = plt.subplots()
ax.hist(w, color='red', label='w', bins=20)
ax.set(xlabel="Proportion of the year covered", title="Weights")
ax.legend()
plt.show()
```

## first neural network

We fit a simple neural network to $y_1$, tentatively:

``` python
model = keras.Sequential([
    layers.Dense(1, activation="sigmoid", input_dim=9),
])
model.compile(optimizer="rmsprop",
              loss="binary_crossentropy",
              metrics=["accuracy"])
model.fit(X.values[:3200,:], y1.values[:3200],epochs=5, batch_size=128)
```
